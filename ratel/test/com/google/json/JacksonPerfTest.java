/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package com.google.json;

import com.google.dao.*;
import com.google.ratel.deps.jackson.annotation.JsonInclude;
import com.google.ratel.deps.jackson.databind.ObjectMapper;
import java.util.*;

/**
 *
 */
public class JacksonPerfTest {

    int count = 5000;

    int warmup = 5;

    ObjectMapper mapper;

    public void testFromJson() {
        try {
            //String json = "[{\"id\":0,\"firstName\":\"Joshua\",\"lastName\":\"Jasper\",\"state\":\"Hawaii\"},{\"id\":1,\"firstName\":\"David\",\"lastName\":\"Jetter\",\"state\":\"Maine\"},{\"id\":2,\"firstName\":\"Colin\",\"lastName\":\"Baker\",\"state\":\"Pennsylvania\"},{\"id\":3,\"firstName\":\"Brittany\",\"lastName\":\"Aaron\",\"state\":\"Idaho\"},{\"id\":4,\"firstName\":\"Cristman\",\"lastName\":\"Badger\",\"state\":\"Alaska\"},{\"id\":5,\"firstName\":\"Billy\",\"lastName\":\"Towers\",\"state\":\"Nebraska\"},{\"id\":6,\"firstName\":\"Andrew\",\"lastName\":\"Downs\",\"state\":\"Idaho\"},{\"id\":7,\"firstName\":\"Cristman\",\"lastName\":\"Jetter\",\"state\":\"Washington\"},{\"id\":8,\"firstName\":\"Emma\",\"lastName\":\"O'Malley\",\"state\":\"Colorado\"},{\"id\":9,\"firstName\":\"Colin\",\"lastName\":\"Bolingbroke\",\"state\":\"New York\"},{\"id\":10,\"firstName\":\"Cristman\",\"lastName\":\"Aaron\",\"state\":\"New Mexico\"},{\"id\":11,\"firstName\":\"Sarah\",\"lastName\":\"Towers\",\"state\":\"California\"},{\"id\":12,\"firstName\":\"Royalle\",\"lastName\":\"Crounse\",\"state\":\"Colorado\"},{\"id\":13,\"firstName\":\"Colin\",\"lastName\":\"Towers\",\"state\":\"Massachusetts\"},{\"id\":14,\"firstName\":\"Hannah\",\"lastName\":\"O'Leary\",\"state\":\"Delaware\"},{\"id\":15,\"firstName\":\"Michael\",\"lastName\":\"Bagley\",\"state\":\"West Virginia\"},{\"id\":16,\"firstName\":\"Olivia\",\"lastName\":\"Bolingbroke\",\"state\":\"Delaware\"},{\"id\":17,\"firstName\":\"Colin\",\"lastName\":\"Jasper\",\"state\":\"Connecticut\"},{\"id\":18,\"firstName\":\"Andrew\",\"lastName\":\"Drake\",\"state\":\"Nebraska\"},{\"id\":19,\"firstName\":\"Matthew\",\"lastName\":\"Bolingbroke\",\"state\":\"Montana\"},{\"id\":20,\"firstName\":\"Sarah\",\"lastName\":\"Towers\",\"state\":\"Connecticut\"},{\"id\":21,\"firstName\":\"Andrew\",\"lastName\":\"Jasper\",\"state\":\"Maryland\"},{\"id\":22,\"firstName\":\"Royalle\",\"lastName\":\"Jasper\",\"state\":\"Missouri\"},{\"id\":23,\"firstName\":\"Olivia\",\"lastName\":\"Bagley\",\"state\":\"Indiana\"},{\"id\":24,\"firstName\":\"Colin\",\"lastName\":\"Wakefield\",\"state\":\"North Carolina\"},{\"id\":25,\"firstName\":\"Colin\",\"lastName\":\"Waller\",\"state\":\"New York\"},{\"id\":26,\"firstName\":\"Warner\",\"lastName\":\"Jasper\",\"state\":\"Pennsylvania\"},{\"id\":27,\"firstName\":\"David\",\"lastName\":\"Duff\",\"state\":\"Massachusetts\"},{\"id\":28,\"firstName\":\"Warner\",\"lastName\":\"Downs\",\"state\":\"Connecticut\"},{\"id\":29,\"firstName\":\"Sarah\",\"lastName\":\"Neville\",\"state\":\"Michigan\"},{\"id\":30,\"firstName\":\"Andrew\",\"lastName\":\"Towers\",\"state\":\"New York\"},{\"id\":31,\"firstName\":\"Cletus\",\"lastName\":\"Wakefield\",\"state\":\"Arizona\"},{\"id\":32,\"firstName\":\"Royalle\",\"lastName\":\"Bagley\",\"state\":\"Kentucky\"},{\"id\":33,\"firstName\":\"Michael\",\"lastName\":\"Neville\",\"state\":\"Michigan\"},{\"id\":34,\"firstName\":\"Emma\",\"lastName\":\"Wakefield\",\"state\":\"Nebraska\"},{\"id\":35,\"firstName\":\"Madison\",\"lastName\":\"Trull\",\"state\":\"Alabama\"},{\"id\":36,\"firstName\":\"Madison\",\"lastName\":\"Bagley\",\"state\":\"Alaska\"},{\"id\":37,\"firstName\":\"Cristman\",\"lastName\":\"O'Malley\",\"state\":\"Connecticut\"},{\"id\":38,\"firstName\":\"Olivia\",\"lastName\":\"Aaron\",\"state\":\"Minnesota\"},{\"id\":39,\"firstName\":\"Emily\",\"lastName\":\"Duff\",\"state\":\"Kentucky\"},{\"id\":40,\"firstName\":\"Colin\",\"lastName\":\"Wakefield\",\"state\":\"Illinois\"},{\"id\":41,\"firstName\":\"Brittany\",\"lastName\":\"Towers\",\"state\":\"South Dakota\"},{\"id\":42,\"firstName\":\"Andrew\",\"lastName\":\"Trull\",\"state\":\"Hawaii\"},{\"id\":43,\"firstName\":\"Daniel\",\"lastName\":\"Aaron\",\"state\":\"Alaska\"},{\"id\":44,\"firstName\":\"Emily\",\"lastName\":\"Tripp\",\"state\":\"North Carolina\"},{\"id\":45,\"firstName\":\"Matthew\",\"lastName\":\"Bagley\",\"state\":\"Delaware\"},{\"id\":46,\"firstName\":\"Brittany\",\"lastName\":\"Neville\",\"state\":\"Oklahoma\"},{\"id\":47,\"firstName\":\"David\",\"lastName\":\"Bolingbroke\",\"state\":\"Illinois\"},{\"id\":48,\"firstName\":\"Brittany\",\"lastName\":\"Jasper\",\"state\":\"New Mexico\"},{\"id\":49,\"firstName\":\"Billy\",\"lastName\":\"O'Leary\",\"state\":\"Iowa\"}]";
            String json = "[{\"id\":0,\"firstName\":\"Matthew\",\"lastName\":\"Bagley\",\"state\":\"Minnesota\",\"birthDate\":733733025784},{\"id\":1,\"firstName\":\"Jacob\",\"lastName\":\"Driver\",\"state\":\"New Hampshire\",\"birthDate\":210840225784},{\"id\":2,\"firstName\":\"Hannah\",\"lastName\":\"Tripp\",\"state\":\"Rhode Island\",\"birthDate\":231662625784},{\"id\":3,\"firstName\":\"Cristman\",\"lastName\":\"Wakefield\",\"state\":\"New Jersey\",\"birthDate\":868085025784},{\"id\":4,\"firstName\":\"Joshua\",\"lastName\":\"Bagley\",\"state\":\"Texas\",\"birthDate\":103445025784},{\"id\":5,\"firstName\":\"Emily\",\"lastName\":\"Jetter\",\"state\":\"New Jersey\",\"birthDate\":759221025784},{\"id\":6,\"firstName\":\"Hannah\",\"lastName\":\"Duff\",\"state\":\"Kansas\",\"birthDate\":516005025784},{\"id\":7,\"firstName\":\"Cletus\",\"lastName\":\"Driver\",\"state\":\"Maine\",\"birthDate\":549528225784},{\"id\":8,\"firstName\":\"Jacob\",\"lastName\":\"Tripp\",\"state\":\"Nebraska\",\"birthDate\":105432225784},{\"id\":9,\"firstName\":\"Warner\",\"lastName\":\"O'Malley\",\"state\":\"Oregon\",\"birthDate\":494145825784},{\"id\":10,\"firstName\":\"Emily\",\"lastName\":\"Drake\",\"state\":\"Texas\",\"birthDate\":820133025784},{\"id\":11,\"firstName\":\"Brittany\",\"lastName\":\"Downs\",\"state\":\"Ohio\",\"birthDate\":807173025784},{\"id\":12,\"firstName\":\"Emma\",\"lastName\":\"Duff\",\"state\":\"Tennessee\",\"birthDate\":-560193374216},{\"id\":13,\"firstName\":\"Cristman\",\"lastName\":\"Baker\",\"state\":\"Idaho\",\"birthDate\":72168225784},{\"id\":14,\"firstName\":\"Brittany\",\"lastName\":\"Trull\",\"state\":\"New Jersey\",\"birthDate\":-17860574216},{\"id\":15,\"firstName\":\"Hannah\",\"lastName\":\"Downs\",\"state\":\"Hawaii\",\"birthDate\":-25809374216},{\"id\":16,\"firstName\":\"Warner\",\"lastName\":\"Tripp\",\"state\":\"Arizona\",\"birthDate\":690533025784},{\"id\":17,\"firstName\":\"Joshua\",\"lastName\":\"Bolingbroke\",\"state\":\"Kentucky\",\"birthDate\":564648225784},{\"id\":18,\"firstName\":\"Sarah\",\"lastName\":\"Jetter\",\"state\":\"Georgia\",\"birthDate\":772353825784},{\"id\":19,\"firstName\":\"Sarah\",\"lastName\":\"Duff\",\"state\":\"Nevada\",\"birthDate\":758443425784},{\"id\":20,\"firstName\":\"Emma\",\"lastName\":\"Duff\",\"state\":\"Minnesota\",\"birthDate\":-511290974216},{\"id\":21,\"firstName\":\"Hannah\",\"lastName\":\"Jasper\",\"state\":\"Florida\",\"birthDate\":896683425784},{\"id\":22,\"firstName\":\"Madison\",\"lastName\":\"Downs\",\"state\":\"South Dakota\",\"birthDate\":696235425784},{\"id\":23,\"firstName\":\"Olivia\",\"lastName\":\"Duff\",\"state\":\"Maine\",\"birthDate\":172305825785},{\"id\":24,\"firstName\":\"Brittany\",\"lastName\":\"Driver\",\"state\":\"Indiana\",\"birthDate\":-326999774215},{\"id\":25,\"firstName\":\"Warner\",\"lastName\":\"Baker\",\"state\":\"Kentucky\",\"birthDate\":711441825785},{\"id\":26,\"firstName\":\"Emily\",\"lastName\":\"Bagley\",\"state\":\"Maryland\",\"birthDate\":29141025785},{\"id\":27,\"firstName\":\"Emily\",\"lastName\":\"Drake\",\"state\":\"Nebraska\",\"birthDate\":-325876574215},{\"id\":28,\"firstName\":\"Royalle\",\"lastName\":\"Badger\",\"state\":\"Wisconsin\",\"birthDate\":-98730974215},{\"id\":29,\"firstName\":\"Billy\",\"lastName\":\"Jetter\",\"state\":\"Minnesota\",\"birthDate\":-210100574215},{\"id\":30,\"firstName\":\"Cletus\",\"lastName\":\"Neville\",\"state\":\"New Jersey\",\"birthDate\":964334625785},{\"id\":31,\"firstName\":\"Cletus\",\"lastName\":\"Driver\",\"state\":\"Illinois\",\"birthDate\":72773025785},{\"id\":32,\"firstName\":\"David\",\"lastName\":\"Baker\",\"state\":\"Indiana\",\"birthDate\":811406625785},{\"id\":33,\"firstName\":\"Cletus\",\"lastName\":\"Aaron\",\"state\":\"Illinois\",\"birthDate\":-532545374215},{\"id\":34,\"firstName\":\"Warner\",\"lastName\":\"O'Malley\",\"state\":\"New Jersey\",\"birthDate\":245400225785},{\"id\":35,\"firstName\":\"Cristman\",\"lastName\":\"Neville\",\"state\":\"North Carolina\",\"birthDate\":-270839774215},{\"id\":36,\"firstName\":\"Joshua\",\"lastName\":\"Wakefield\",\"state\":\"Alabama\",\"birthDate\":-88708574215},{\"id\":37,\"firstName\":\"Olivia\",\"lastName\":\"Driver\",\"state\":\"Alaska\",\"birthDate\":680337825785},{\"id\":38,\"firstName\":\"Andrew\",\"lastName\":\"O'Leary\",\"state\":\"Delaware\",\"birthDate\":849163425785},{\"id\":39,\"firstName\":\"David\",\"lastName\":\"Drake\",\"state\":\"Minnesota\",\"birthDate\":840955425785},{\"id\":40,\"firstName\":\"David\",\"lastName\":\"Bolingbroke\",\"state\":\"Georgia\",\"birthDate\":-157569374215},{\"id\":41,\"firstName\":\"Royalle\",\"lastName\":\"Waller\",\"state\":\"Ohio\",\"birthDate\":-347476574215},{\"id\":42,\"firstName\":\"Jacob\",\"lastName\":\"Neville\",\"state\":\"Wyoming\",\"birthDate\":791966625785},{\"id\":43,\"firstName\":\"Matthew\",\"lastName\":\"Bolingbroke\",\"state\":\"Minnesota\",\"birthDate\":-461697374215},{\"id\":44,\"firstName\":\"Jacob\",\"lastName\":\"Bagley\",\"state\":\"Louisiana\",\"birthDate\":286353825785},{\"id\":45,\"firstName\":\"Billy\",\"lastName\":\"Downs\",\"state\":\"Delaware\",\"birthDate\":-294686174215},{\"id\":46,\"firstName\":\"David\",\"lastName\":\"Wakefield\",\"state\":\"Idaho\",\"birthDate\":27585825785},{\"id\":47,\"firstName\":\"Royalle\",\"lastName\":\"Jetter\",\"state\":\"Colorado\",\"birthDate\":543739425785},{\"id\":48,\"firstName\":\"Colin\",\"lastName\":\"Jetter\",\"state\":\"Oklahoma\",\"birthDate\":-195758174215},{\"id\":49,\"firstName\":\"Warner\",\"lastName\":\"Drake\",\"state\":\"Minnesota\",\"birthDate\":533112225785}]";
            //String json = "[{\"id\":0,\"firstName\":\"Daniel\",\"lastName\":\"Crounse\",\"state\":\"Louisiana\",\"birthDate\":-163006499920},{\"id\":1,\"firstName\":\"Jacob\",\"lastName\":\"Jasper\",\"state\":\"Louisiana\",\"birthDate\":260007900080},{\"id\":2,\"firstName\":\"Sarah\",\"lastName\":\"Duff\",\"state\":\"Pennsylvania\",\"birthDate\":-72632099920},{\"id\":3,\"firstName\":\"Cristman\",\"lastName\":\"Drake\",\"state\":\"Alabama\",\"birthDate\":436782300080},{\"id\":4,\"firstName\":\"Matthew\",\"lastName\":\"Tripp\",\"state\":\"Maryland\",\"birthDate\":-129396899920},{\"id\":5,\"firstName\":\"Colin\",\"lastName\":\"Driver\",\"state\":\"Arkansas\",\"birthDate\":456222300080},{\"id\":6,\"firstName\":\"Michael\",\"lastName\":\"Driver\",\"state\":\"Louisiana\",\"birthDate\":235211100080},{\"id\":7,\"firstName\":\"Madison\",\"lastName\":\"Crounse\",\"state\":\"West Virginia\",\"birthDate\":955268700080},{\"id\":8,\"firstName\":\"David\",\"lastName\":\"Duff\",\"state\":\"Hawaii\",\"birthDate\":944987100080},{\"id\":9,\"firstName\":\"David\",\"lastName\":\"Baker\",\"state\":\"Oregon\",\"birthDate\":113905500080},{\"id\":10,\"firstName\":\"Warner\",\"lastName\":\"Drake\",\"state\":\"California\",\"birthDate\":768903900080},{\"id\":11,\"firstName\":\"Olivia\",\"lastName\":\"Bagley\",\"state\":\"Iowa\",\"birthDate\":173003100081},{\"id\":12,\"firstName\":\"Hannah\",\"lastName\":\"Aaron\",\"state\":\"Tennessee\",\"birthDate\":701166300081},{\"id\":13,\"firstName\":\"Billy\",\"lastName\":\"Baker\",\"state\":\"Hawaii\",\"birthDate\":610273500081},{\"id\":14,\"firstName\":\"Matthew\",\"lastName\":\"Duff\",\"state\":\"Missouri\",\"birthDate\":150279900081},{\"id\":15,\"firstName\":\"Brittany\",\"lastName\":\"Duff\",\"state\":\"Illinois\",\"birthDate\":-201022499919},{\"id\":16,\"firstName\":\"Daniel\",\"lastName\":\"Waller\",\"state\":\"Connecticut\",\"birthDate\":89713500081},{\"id\":17,\"firstName\":\"Madison\",\"lastName\":\"Tripp\",\"state\":\"Maryland\",\"birthDate\":51697500081},{\"id\":18,\"firstName\":\"Emma\",\"lastName\":\"Bagley\",\"state\":\"Oregon\",\"birthDate\":485252700081},{\"id\":19,\"firstName\":\"Sarah\",\"lastName\":\"Duff\",\"state\":\"Wisconsin\",\"birthDate\":635761500081},{\"id\":20,\"firstName\":\"Emily\",\"lastName\":\"Badger\",\"state\":\"Tennessee\",\"birthDate\":195726300081},{\"id\":21,\"firstName\":\"Olivia\",\"lastName\":\"Drake\",\"state\":\"Idaho\",\"birthDate\":220609500081},{\"id\":22,\"firstName\":\"Olivia\",\"lastName\":\"Waller\",\"state\":\"Pennsylvania\",\"birthDate\":426155100081},{\"id\":23,\"firstName\":\"David\",\"lastName\":\"O\\u0027Malley\",\"state\":\"Nebraska\",\"birthDate\":366107100081},{\"id\":24,\"firstName\":\"Royalle\",\"lastName\":\"Bolingbroke\",\"state\":\"Alaska\",\"birthDate\":-272302499919},{\"id\":25,\"firstName\":\"Sarah\",\"lastName\":\"Baker\",\"state\":\"Virginia\",\"birthDate\":-240075299919},{\"id\":26,\"firstName\":\"Cletus\",\"lastName\":\"Trull\",\"state\":\"Rhode Island\",\"birthDate\":810980700081},{\"id\":27,\"firstName\":\"Billy\",\"lastName\":\"O\\u0027Leary\",\"state\":\"New Mexico\",\"birthDate\":436091100081},{\"id\":28,\"firstName\":\"Emily\",\"lastName\":\"Towers\",\"state\":\"Minnesota\",\"birthDate\":-366219299919},{\"id\":29,\"firstName\":\"Hannah\",\"lastName\":\"Jasper\",\"state\":\"Kansas\",\"birthDate\":407492700081},{\"id\":30,\"firstName\":\"Joshua\",\"lastName\":\"Aaron\",\"state\":\"Rhode Island\",\"birthDate\":957601500081},{\"id\":31,\"firstName\":\"Brittany\",\"lastName\":\"Duff\",\"state\":\"Nevada\",\"birthDate\":444212700081},{\"id\":32,\"firstName\":\"Emily\",\"lastName\":\"Aaron\",\"state\":\"Hawaii\",\"birthDate\":-176916899919},{\"id\":33,\"firstName\":\"Joshua\",\"lastName\":\"Neville\",\"state\":\"Oregon\",\"birthDate\":-31505699919},{\"id\":34,\"firstName\":\"Royalle\",\"lastName\":\"Duff\",\"state\":\"Delaware\",\"birthDate\":-384708899919},{\"id\":35,\"firstName\":\"Cristman\",\"lastName\":\"Driver\",\"state\":\"Missouri\",\"birthDate\":641031900081},{\"id\":36,\"firstName\":\"Emma\",\"lastName\":\"Bagley\",\"state\":\"Oklahoma\",\"birthDate\":515147100081},{\"id\":37,\"firstName\":\"Olivia\",\"lastName\":\"Bagley\",\"state\":\"Missouri\",\"birthDate\":-499016099919},{\"id\":38,\"firstName\":\"Royalle\",\"lastName\":\"Duff\",\"state\":\"Indiana\",\"birthDate\":444903900081},{\"id\":39,\"firstName\":\"Jacob\",\"lastName\":\"Crounse\",\"state\":\"Alaska\",\"birthDate\":-437240099918},{\"id\":40,\"firstName\":\"Olivia\",\"lastName\":\"Driver\",\"state\":\"Pennsylvania\",\"birthDate\":196935900082},{\"id\":41,\"firstName\":\"Madison\",\"lastName\":\"Duff\",\"state\":\"Ohio\",\"birthDate\":859883100082},{\"id\":42,\"firstName\":\"Billy\",\"lastName\":\"Trull\",\"state\":\"Michigan\",\"birthDate\":-452446499918},{\"id\":43,\"firstName\":\"David\",\"lastName\":\"Wakefield\",\"state\":\"Alabama\",\"birthDate\":366711900082},{\"id\":44,\"firstName\":\"Sarah\",\"lastName\":\"Driver\",\"state\":\"Ohio\",\"birthDate\":-75656099918},{\"id\":45,\"firstName\":\"Warner\",\"lastName\":\"Wakefield\",\"state\":\"Massachusetts\",\"birthDate\":214647900082},{\"id\":46,\"firstName\":\"Brittany\",\"lastName\":\"Bagley\",\"state\":\"Iowa\",\"birthDate\":889518300082},{\"id\":47,\"firstName\":\"Sarah\",\"lastName\":\"O\\u0027Malley\",\"state\":\"Louisiana\",\"birthDate\":509963100082},{\"id\":48,\"firstName\":\"Emily\",\"lastName\":\"O\\u0027Leary\",\"state\":\"Montana\",\"birthDate\":-94491299918},{\"id\":49,\"firstName\":\"David\",\"lastName\":\"Bolingbroke\",\"state\":\"Massachusetts\",\"birthDate\":210414300082}]";
 

            Customer[] customers = null;
            for (int i = 0; i < warmup; i++) {
                customers = mapper.readValue(json, Customer[].class);
            }

            long start = System.currentTimeMillis();

            for (int i = 0; i < count; i++) {
                customers = mapper.readValue(json, Customer[].class);
            }

            long time = (System.currentTimeMillis() - start);
            System.out.println("Jackson FromJson customer count: " + customers.length + ", time: " + time);

        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    public void testToJson() {
        try {
            List<Customer> customers = CustomerDao.getInstance().findAll();

            int size = 0;
            for (int i = 0; i < warmup; i++) {
                String json = mapper.writeValueAsString(customers);
                size = json.length();
            }

            long start = System.currentTimeMillis();

            for (int i = 0; i < count; i++) {
                String json = mapper.writeValueAsString(customers);
                //System.out.println(json);
                //System.out.println(" ");
                size = json.length();
            }

            long time = (System.currentTimeMillis() - start);
            System.out.println("Jackson ToJson size: " + size + ", time: " + time);
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    public static void main(String args[]) {
        JacksonPerfTest test = new JacksonPerfTest();
        test.mapper = new ObjectMapper();
        
        //DateFormat format = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssz");
        //test.mapper.setDateFormat(format);
        test.mapper.setSerializationInclusion(JsonInclude.Include.NON_NULL);
        test.testToJson();
        test.testFromJson();
    }
}
